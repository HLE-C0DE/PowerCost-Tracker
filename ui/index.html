<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerCost Tracker</title>
    <link rel="stylesheet" href="src/styles/main.css">
</head>
<body>
    <div id="app">
        <!-- Navigation -->
        <nav class="sidebar" id="sidebar">
            <div class="logo">
                <button class="sidebar-toggle" id="sidebar-toggle" title="Toggle sidebar">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="6" x2="21" y2="6"/>
                        <line x1="3" y1="12" x2="21" y2="12"/>
                        <line x1="3" y1="18" x2="21" y2="18"/>
                    </svg>
                </button>
                <svg class="logo-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                </svg>
                <span class="logo-text">PowerCost</span>
            </div>
            <ul class="nav-links">
                <li><a href="#dashboard" class="nav-link active" data-view="dashboard">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="9"/>
                        <rect x="14" y="3" width="7" height="5"/>
                        <rect x="14" y="12" width="7" height="9"/>
                        <rect x="3" y="16" width="7" height="5"/>
                    </svg>
                    <span data-i18n="nav.dashboard">Dashboard</span>
                </a></li>
                <li><a href="#history" class="nav-link" data-view="history">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
                    </svg>
                    <span data-i18n="nav.history">History</span>
                </a></li>
                <li><a href="#settings" class="nav-link" data-view="settings">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="4" y1="21" x2="4" y2="14"/>
                        <line x1="4" y1="10" x2="4" y2="3"/>
                        <line x1="12" y1="21" x2="12" y2="12"/>
                        <line x1="12" y1="8" x2="12" y2="3"/>
                        <line x1="20" y1="21" x2="20" y2="16"/>
                        <line x1="20" y1="12" x2="20" y2="3"/>
                        <line x1="1" y1="14" x2="7" y2="14"/>
                        <line x1="9" y1="8" x2="15" y2="8"/>
                        <line x1="17" y1="16" x2="23" y2="16"/>
                    </svg>
                    <span data-i18n="nav.settings">Settings</span>
                </a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="content">
            <!-- Dashboard View -->
            <section id="dashboard" class="view active">
                <header class="view-header">
                    <h1 data-i18n="nav.dashboard">Dashboard</h1>
                    <div class="header-controls">
                        <!-- Stream A: Global Display Toggle -->
                        <div class="global-display-toggle" id="global-display-toggle" data-i18n-title="dashboard.display_mode_title">
                            <button class="global-display-btn active" data-mode="normal" data-i18n="dashboard.mode.normal">Normal</button>
                            <button class="global-display-btn" data-mode="minimize" data-i18n="dashboard.mode.minimal">Minimal</button>
                        </div>
                        <div class="status-badge" id="source-badge">
                            <span class="status-dot"></span>
                            <span id="power-source">--</span>
                        </div>
                        <button class="btn btn-icon" id="edit-dashboard-btn" data-i18n-title="dashboard.edit_title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/>
                                <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
                            </svg>
                        </button>
                    </div>
                </header>

                <!-- Edit Mode Toolbar -->
                <div class="edit-toolbar hidden" id="edit-toolbar">
                    <span class="edit-mode-indicator">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                            <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/>
                            <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
                        </svg>
                        <span data-i18n="dashboard.edit_mode">Edit Mode</span>
                    </span>
                    <div class="layout-profiles-section">
                        <div class="profile-controls">
                            <select id="profile-selector" class="profile-select">
                                <option value="">-- Custom --</option>
                            </select>
                            <button class="btn btn-icon btn-sm" id="save-profile-btn" title="Save Profile">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                    <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/>
                                    <polyline points="17 21 17 13 7 13 7 21"/>
                                    <polyline points="7 3 7 8 15 8"/>
                                </svg>
                            </button>
                            <button class="btn btn-icon btn-sm" id="delete-profile-btn" title="Delete Profile">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                    <polyline points="3 6 5 6 21 6"/>
                                    <path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="edit-toolbar-actions">
                        <button class="btn btn-secondary btn-sm" id="fix-layout-btn" title="Reset widgets to default positions">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <rect x="3" y="3" width="7" height="7"/>
                                <rect x="14" y="3" width="7" height="7"/>
                                <rect x="3" y="14" width="7" height="7"/>
                                <rect x="14" y="14" width="7" height="7"/>
                            </svg>
                            <span data-i18n="dashboard.default_layout">Default Layout</span>
                        </button>
                        <button class="btn btn-secondary btn-sm" id="toggle-visibility-btn">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                                <circle cx="12" cy="12" r="3"/>
                            </svg>
                            <span data-i18n="dashboard.toggle_widgets">Toggle Widgets</span>
                        </button>
                        <button class="btn btn-primary btn-sm" id="exit-edit-mode-btn" data-i18n="dashboard.done">Done</button>
                    </div>
                </div>

                <!-- Visibility Panel -->
                <div class="visibility-panel hidden" id="visibility-panel">
                    <div class="visibility-panel-header">
                        <h3 data-i18n="dashboard.toggle_visibility">Toggle Widget Visibility</h3>
                        <button class="btn btn-icon btn-sm" id="close-visibility-panel">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="18" y1="6" x2="6" y2="18"/>
                                <line x1="6" y1="6" x2="18" y2="18"/>
                            </svg>
                        </button>
                    </div>
                    <div class="visibility-list" id="visibility-list">
                        <!-- Widget visibility toggles will be rendered here -->
                    </div>
                </div>

                <!-- Dashboard Grid Container -->
                <div class="dashboard-grid" id="dashboard-grid">
                    <!-- Widgets will be dynamically rendered here -->
                </div>

                <!-- Estimation Warning -->
                <div id="estimation-warning" class="warning-banner hidden">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
                        <line x1="12" y1="9" x2="12" y2="13"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                    <span data-i18n="warning.estimated_values">Values are estimated and may not be accurate</span>
                </div>
            </section>

            <!-- History View -->
            <section id="history" class="view">
                <header class="view-header">
                    <h1 data-i18n="nav.history">History</h1>
                </header>

                <!-- Shared period filters -->
                <div class="history-filters">
                    <div class="segmented-control" id="history-range-control">
                        <div class="segmented-indicator"></div>
                        <button class="active" data-range="7" data-i18n="history.7_days">7 Days</button>
                        <button data-range="30" data-i18n="history.30_days">30 Days</button>
                        <button data-range="365" data-i18n="history.12_months">12 Months</button>
                        <button data-range="custom" data-i18n="history.custom">Custom</button>
                    </div>
                    <div class="history-custom-range hidden" id="history-custom-range">
                        <input type="date" id="history-range-start">
                        <input type="date" id="history-range-end">
                        <button class="btn btn-sm btn-primary" id="history-range-apply" data-i18n="history.apply">Apply</button>
                    </div>
                    <div class="history-range-nav">
                        <button class="btn btn-icon btn-sm" id="history-nav-prev">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                        </button>
                        <span id="history-range-label"></span>
                        <button class="btn btn-icon btn-sm" id="history-nav-next">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                        </button>
                    </div>
                </div>

                <!-- Mode toggle: Power / Sessions + Category Filter -->
                <div class="history-mode-row">
                    <div class="segmented-control segmented-control--mode" id="history-mode-control">
                        <div class="segmented-indicator"></div>
                        <button class="active" data-mode="power" data-i18n="history.tab.power">Power</button>
                        <button data-mode="sessions" data-i18n="history.tab.sessions">Sessions</button>
                    </div>
                    <div class="session-category-filter hidden" id="session-category-filter"></div>
                </div>

                <!-- Power content -->
                <div id="history-power-content">
                    <div class="history-stats">
                        <div class="stat-card stat-card--energy">
                            <div class="stat-card-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                                </svg>
                            </div>
                            <div class="stat-card-content">
                                <span class="stat-label" data-i18n="history.total_consumption">Total Consumption</span>
                                <span class="stat-value" id="history-total-wh">-- kWh</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--cost">
                            <div class="stat-card-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/>
                                </svg>
                            </div>
                            <div class="stat-card-content">
                                <span class="stat-label" data-i18n="history.total_cost">Total Cost</span>
                                <span class="stat-value" id="history-total-cost">--</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--avg">
                            <div class="stat-card-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
                                </svg>
                            </div>
                            <div class="stat-card-content">
                                <span class="stat-label" data-i18n="history.average_power">Average Power</span>
                                <span class="stat-value" id="history-avg-power">-- W</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--peak">
                            <div class="stat-card-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/>
                                    <polyline points="17 6 23 6 23 12"/>
                                </svg>
                            </div>
                            <div class="stat-card-content">
                                <span class="stat-label" data-i18n="history.peak_power">Peak Power</span>
                                <span class="stat-value" id="history-peak-power">-- W</span>
                            </div>
                        </div>
                    </div>

                    <div class="history-chart-container">
                        <div class="history-chart-header">
                            <h3 data-i18n="history.energy">Energy</h3>
                            <span class="history-rate-badge" id="history-rate-badge"></span>
                        </div>
                        <canvas id="history-chart"></canvas>
                    </div>

                    <!-- Daily Breakdown Table -->
                    <div class="daily-breakdown" id="daily-breakdown">
                        <h3 data-i18n="history.daily_breakdown">Daily Breakdown</h3>
                        <div class="breakdown-table-wrapper">
                            <table class="breakdown-table">
                                <thead>
                                    <tr>
                                        <th data-i18n="history.date">Date</th>
                                        <th data-i18n="history.energy">Energy</th>
                                        <th data-i18n="history.avg">Avg</th>
                                        <th data-i18n="history.peak">Peak</th>
                                        <th data-i18n="history.cost">Cost</th>
                                        <th data-i18n="history.usage">Usage</th>
                                    </tr>
                                </thead>
                                <tbody id="breakdown-table-body">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div id="no-history-data" class="empty-state hidden">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <path d="M9 17H7A5 5 0 017 7h2M15 7h2a5 5 0 010 10h-2M8 12h8"/>
                        </svg>
                        <p data-i18n="history.no_data">No data available for this period</p>
                    </div>
                </div>

                <!-- Sessions content -->
                <div id="history-sessions-content" class="hidden">
                    <!-- Session Summary Stats -->
                    <div class="history-stats">
                        <div class="stat-card stat-card--energy">
                            <div class="stat-card-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
                                </svg>
                            </div>
                            <div class="stat-card-content">
                                <span class="stat-label">Sessions</span>
                                <span class="stat-value" id="session-total-count">--</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--peak">
                            <div class="stat-card-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                                </svg>
                            </div>
                            <div class="stat-card-content">
                                <span class="stat-label">Total Energy</span>
                                <span class="stat-value" id="session-total-energy">-- Wh</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--energy">
                            <div class="stat-card-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                                </svg>
                            </div>
                            <div class="stat-card-content">
                                <span class="stat-label">Total Surplus</span>
                                <span class="stat-value" id="session-total-surplus">-- Wh</span>
                            </div>
                        </div>
                        <div class="stat-card stat-card--cost">
                            <div class="stat-card-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/>
                                </svg>
                            </div>
                            <div class="stat-card-content">
                                <span class="stat-label">Total Cost</span>
                                <span class="stat-value" id="session-total-cost">--</span>
                            </div>
                        </div>
                    </div>

                    <!-- Histogram Canvas -->
                    <div class="session-histogram-container">
                        <div class="history-chart-header">
                            <h3>Sessions</h3>
                        </div>
                        <canvas id="session-histogram"></canvas>
                    </div>

                    <!-- Session List -->
                    <div class="session-list" id="session-list">
                        <!-- Sessions will be dynamically rendered here -->
                    </div>
                    <div id="no-sessions" class="empty-state hidden">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <circle cx="12" cy="12" r="10"/>
                            <polyline points="12 6 12 12 16 14"/>
                        </svg>
                        <p data-i18n="history.no_sessions">No sessions recorded yet</p>
                    </div>
                </div>
            </section>

            <!-- Settings View -->
            <section id="settings" class="view">
                <header class="view-header">
                    <h1 data-i18n="nav.settings">Settings</h1>
                </header>

                <div class="settings-container">
                    <!-- General Settings -->
                    <div class="settings-section">
                        <h2 data-i18n="settings.general">General</h2>

                        <div class="setting-row">
                            <label data-i18n="settings.language">Language</label>
                            <select id="setting-language">
                                <option value="auto" data-i18n="settings.language.auto">Auto-detect</option>
                                <option value="en">English</option>
                                <option value="fr">Francais</option>
                            </select>
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.theme">Theme</label>
                            <select id="setting-theme">
                                <option value="dark" data-i18n="settings.theme.dark">Dark</option>
                                <option value="light" data-i18n="settings.theme.light">Light</option>
                                <option value="system" data-i18n="settings.theme.system">System</option>
                            </select>
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.refresh_rate_critical">Refresh Rate (Critical)</label>
                            <select id="setting-refresh-rate">
                                <option value="500">0.5s</option>
                                <option value="1000">1s</option>
                                <option value="2000">2s</option>
                                <option value="5000">5s</option>
                                <option value="10000">10s</option>
                            </select>
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.refresh_rate_detailed">Refresh Rate (Detailed)</label>
                            <select id="setting-slow-refresh-rate">
                                <option value="3000">3s</option>
                                <option value="5000">5s</option>
                                <option value="10000">10s</option>
                                <option value="15000">15s</option>
                                <option value="30000">30s</option>
                            </select>
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.eco_mode">Eco Mode</label>
                            <label class="toggle">
                                <input type="checkbox" id="setting-eco-mode">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.start_minimized">Start Minimized</label>
                            <label class="toggle">
                                <input type="checkbox" id="setting-start-minimized">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.start_with_system">Start with System</label>
                            <label class="toggle">
                                <input type="checkbox" id="setting-start-with-system">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.remember_window_position">Remember window position and size</label>
                            <label class="toggle">
                                <input type="checkbox" id="setting-remember-window-position">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row" id="run-as-admin-row" style="display: none;">
                            <div style="flex: 1;">
                                <label data-i18n="settings.run_as_admin">Run as Administrator</label>
                                <small class="setting-description" data-i18n="settings.run_as_admin.tooltip" style="display: block; opacity: 0.6; margin-top: 2px;">Enables killing protected/system processes. Requires UAC confirmation on startup.</small>
                                <span id="elevation-status" style="font-size: 0.75em; margin-top: 4px; display: inline-block;"></span>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="setting-run-as-admin">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Baseline Settings -->
                    <div class="settings-section">
                        <h2 data-i18n="settings.baseline">Baseline Detection</h2>

                        <div class="setting-row">
                            <label data-i18n="settings.baseline.auto">Auto-detect Baseline</label>
                            <label class="toggle">
                                <input type="checkbox" id="setting-baseline-auto" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row" id="manual-baseline-row">
                            <label data-i18n="settings.baseline.manual">Manual Baseline (W)</label>
                            <input type="number" id="setting-baseline-watts" step="0.1" value="0" min="0">
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.baseline.detected">Detected Baseline</label>
                            <span class="info-text" id="detected-baseline">-- W</span>
                        </div>

                        <button class="btn btn-secondary" id="detect-baseline-btn" data-i18n="settings.baseline.detect_now">Detect Now</button>

                        <div class="setting-row" style="margin-top: var(--spacing-md);">
                            <label data-i18n="settings.process_limit">Process List Limit</label>
                            <input type="number" id="setting-process-limit" step="1" value="10" min="5" max="50">
                        </div>
                    </div>

                    <!-- Pricing Settings -->
                    <div class="settings-section">
                        <h2 data-i18n="settings.pricing">Pricing</h2>

                        <div class="setting-row">
                            <label data-i18n="settings.pricing.mode">Pricing Mode</label>
                            <select id="setting-pricing-mode">
                                <option value="simple" data-i18n="settings.pricing.mode.simple">Simple (flat rate)</option>
                                <option value="peak_offpeak" data-i18n="settings.pricing.mode.peak_offpeak">Peak/Off-peak</option>
                                <option value="seasonal" data-i18n="settings.pricing.mode.seasonal">Seasonal</option>
                                <option value="tempo" data-i18n="settings.pricing.mode.tempo">Tempo (EDF-style)</option>
                            </select>
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.pricing.currency">Currency</label>
                            <select id="setting-currency">
                                <option value="EUR">EUR</option>
                                <option value="USD">$ USD</option>
                                <option value="GBP">GBP</option>
                                <option value="CHF">CHF</option>
                            </select>
                        </div>

                        <!-- Simple pricing -->
                        <div id="pricing-simple" class="pricing-mode-config">
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.rate">Rate per kWh</label>
                                <input type="number" id="setting-rate-kwh" step="0.0001" value="0.2276">
                            </div>
                        </div>

                        <!-- Peak/Off-peak pricing -->
                        <div id="pricing-peak-offpeak" class="pricing-mode-config hidden">
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.peak_rate">Peak Rate</label>
                                <input type="number" id="setting-peak-rate" step="0.0001" value="0.27">
                            </div>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.offpeak_rate">Off-peak Rate</label>
                                <input type="number" id="setting-offpeak-rate" step="0.0001" value="0.20">
                            </div>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.offpeak_start">Off-peak Start</label>
                                <input type="time" id="setting-offpeak-start" value="22:00">
                            </div>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.offpeak_end">Off-peak End</label>
                                <input type="time" id="setting-offpeak-end" value="06:00">
                            </div>
                        </div>

                        <!-- Seasonal pricing -->
                        <div id="pricing-seasonal" class="pricing-mode-config hidden">
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.summer_rate">Summer Rate</label>
                                <input type="number" id="setting-summer-rate" step="0.0001" value="0.20">
                            </div>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.winter_rate">Winter Rate</label>
                                <input type="number" id="setting-winter-rate" step="0.0001" value="0.25">
                            </div>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.winter_months">Winter Months</label>
                                <span class="info-text">Nov - Mar</span>
                            </div>
                        </div>

                        <!-- Tempo pricing (EDF-style) -->
                        <div id="pricing-tempo" class="pricing-mode-config hidden">
                            <h4 class="pricing-subsection" data-i18n="settings.pricing.tempo.blue">Blue Days</h4>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.tempo.peak">Peak</label>
                                <input type="number" id="setting-tempo-blue-peak" step="0.0001" value="0.16">
                            </div>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.tempo.offpeak">Off-peak</label>
                                <input type="number" id="setting-tempo-blue-offpeak" step="0.0001" value="0.13">
                            </div>

                            <h4 class="pricing-subsection" data-i18n="settings.pricing.tempo.white">White Days</h4>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.tempo.peak">Peak</label>
                                <input type="number" id="setting-tempo-white-peak" step="0.0001" value="0.19">
                            </div>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.tempo.offpeak">Off-peak</label>
                                <input type="number" id="setting-tempo-white-offpeak" step="0.0001" value="0.15">
                            </div>

                            <h4 class="pricing-subsection" data-i18n="settings.pricing.tempo.red">Red Days</h4>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.tempo.peak">Peak</label>
                                <input type="number" id="setting-tempo-red-peak" step="0.0001" value="0.76">
                            </div>
                            <div class="setting-row">
                                <label data-i18n="settings.pricing.tempo.offpeak">Off-peak</label>
                                <input type="number" id="setting-tempo-red-offpeak" step="0.0001" value="0.16">
                            </div>
                        </div>
                    </div>

                    <!-- Session Categories Settings -->
                    <div class="settings-section">
                        <h2 data-i18n="settings.categories">Session Categories</h2>
                        <div class="category-list" id="category-list">
                            <!-- Categories rendered dynamically -->
                        </div>
                        <div class="category-add-row">
                            <input type="text" id="category-emoji-input" placeholder="Emoji" maxlength="2" class="category-emoji-field">
                            <input type="text" id="category-name-input" data-i18n-placeholder="settings.categories.name_placeholder" placeholder="Category name" class="category-name-field">
                            <button class="btn btn-sm btn-secondary" id="add-category-btn" data-i18n="settings.categories.add">Add</button>
                        </div>
                    </div>

                    <!-- Widget Settings -->
                    <div class="settings-section">
                        <h2 data-i18n="settings.widget">Widget</h2>

                        <div class="setting-row">
                            <label data-i18n="settings.widget.enabled">Enable Widget</label>
                            <button id="toggle-widget-btn" class="btn btn-secondary" data-i18n="settings.widget.open">Open Widget</button>
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.widget.show_cost">Show Cost</label>
                            <label class="toggle">
                                <input type="checkbox" id="setting-widget-show-cost" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="setting-row">
                            <label data-i18n="settings.widget.position">Position</label>
                            <select id="setting-widget-position">
                                <option value="top_left" data-i18n="settings.widget.position.top_left">Top Left</option>
                                <option value="top_right" data-i18n="settings.widget.position.top_right">Top Right</option>
                                <option value="bottom_left" data-i18n="settings.widget.position.bottom_left">Bottom Left</option>
                                <option value="bottom_right" data-i18n="settings.widget.position.bottom_right">Bottom Right</option>
                            </select>
                        </div>
                    </div>

                    <!-- Save Button -->
                    <div class="settings-actions">
                        <button id="save-settings" class="btn btn-primary" data-i18n="action.save">Save</button>
                        <button id="reset-settings" class="btn btn-secondary" data-i18n="action.reset">Reset</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Process Search Modal -->
    <div class="modal hidden" id="process-search-modal">
        <div class="modal-content process-modal-content">
            <div class="modal-header">
                <h2 data-i18n="processes.all">All Processes</h2>
                <button class="btn btn-icon modal-close" id="close-process-modal">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="process-search-bar">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                        <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                    </svg>
                    <input type="text" id="process-search-input" data-i18n-placeholder="processes.search_placeholder" placeholder="Search processes..." autocomplete="off">
                </div>
                <div class="process-loading-bar hidden" id="process-loading-bar">
                    <div class="process-loading-progress"></div>
                </div>
                <div class="process-modal-header">
                    <span class="process-modal-col-pin"></span>
                    <span class="process-modal-col-name" data-i18n="processes.header.name">Process</span>
                    <span class="process-modal-col-cpu" data-i18n="processes.header.cpu">CPU %</span>
                    <span class="process-modal-col-gpu" data-i18n="processes.header.gpu">GPU %</span>
                    <span class="process-modal-col-ram" data-i18n="processes.header.ram">RAM %</span>
                    <span class="process-modal-col-kill"></span>
                </div>
                <div class="process-modal-list" id="process-modal-list">
                    <!-- Processes will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Dashboard Modal -->
    <div class="modal hidden" id="edit-dashboard-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="dashboard.edit">Edit Dashboard</h2>
                <button class="btn btn-icon modal-close" id="close-edit-modal">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <p class="modal-info" data-i18n="dashboard.edit_hint">Toggle widgets visibility and drag to reorder</p>
                <div class="widget-list" id="widget-toggle-list">
                    <!-- Widget toggles will be rendered here -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="reset-dashboard-btn" data-i18n="dashboard.reset_default">Reset to Default</button>
                <button class="btn btn-primary" id="save-dashboard-btn" data-i18n="action.save">Save</button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container"></div>

    <script type="module" src="src/main.js"></script>
</body>
</html>
